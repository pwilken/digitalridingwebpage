<!DOCTYPE html>
<html>
<head>
    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Page Meta -->
    <title>Dependency Injection</title>
    <meta name="description" content="Eine Einführung zu Proxies" />

    <!-- Mobile Meta -->
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Brand icon -->
    <link rel="shortcut icon" href="/assets/images/favicon.ico" >

    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/csharp.css" />

    <!-- libs -->
    <script src="/assets/js/jquery-3.3.1.min.js"></script>

    <!-- Some specials -->
    <link rel="stylesheet" type="text/css" href="/assets/css/degree-element.css" />
    <script src="/assets/js/degree-element.js"></script>

    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!-- Ghost outputs important style and meta data with this tag -->
        <link rel="canonical" href="https://digitalriding.de/Dependency-Injection" />
    <meta name="referrer" content="origin" />
    <link rel="next" href="/page2/" />

    <meta property="og:site_name" content="Riding the digital wave" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Dependency Injection" />
    <meta property="og:description" content="Eine Einführung zu Proxies" />
    <meta property="og:url" content="https://digitalriding.de/Dependency-Injection" />
    <meta property="og:image" content="/assets/images/syringe.jpg" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Dependency Injection" />
    <meta name="twitter:description" content="Eine Einführung zu Proxies" />
    <meta name="twitter:url" content="https://digitalriding.de/Dependency-Injection" />
    <meta name="twitter:image:src" content="/assets/images/syringe.jpg" />

    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Website",
    "publisher": "Riding the digital wave",
    "name": "Dependency Injection",
    "url": "https://digitalriding.de/Dependency-Injection",
    "image": "/assets/images/syringe.jpg",
    "description": "Eine Einführung zu Proxies"
}
    </script>

    <meta name="generator" content="Jekyll 3.0.0" />
    <link rel="alternate" type="application/rss+xml" title="Riding the digital wave" href="/feed.xml" />


</head>
<body class="home-template nav-closed">

    <!-- The blog navigation links -->
    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        <li class="nav-home " role="presentation"><a href="/">Start</a></li>
        <li class="nav-about " role="presentation"><a href="/#blogpart">Beiträge</a></li>
        <li class="nav-about " role="presentation"><a href="/sites/projects">Projekte</a></li>
        <li class="nav-about " role="presentation"><a href="/sites\about">Über uns</a></li>
        <li class="nav-about " role="presentation"><a href="/author/pierrewilken">Pierre Wilken</a></li>
        <li class="nav-about " role="presentation"><a href="/author/sgoerzen">Sergej Görzen</a></li>
        <li class="nav-about " role="presentation"><a href="/sites/impressum">Impressum</a></li>
        <li class="nav-about " role="presentation"><a href="/sites/dataprotection">Datenschutzerklärung</a></li>
<!--    <li class="nav-fables " role="presentation"><a href="/tag/fables">Fables</a></li>
        <li class="nav-speeches " role="presentation"><a href="/tag/speeches">Speeches</a></li>
        <li class="nav-fiction " role="presentation"><a href="/tag/fiction">Fiction</a></li>
        <li class="nav-author " role="presentation"><a href="/author/casper">Casper</a></li>
        <li class="nav-author " role="presentation"><a href="/author/edgar">Edgar</a></li>
        <li class="nav-author " role="presentation"><a href="/author/abraham">Abraham</a></li>
        <li class="nav-author " role="presentation"><a href="/author/martin">Martin</a></li>
        <li class="nav-author " role="presentation"><a href="/author/lewis">Lewis</a></li>
--> </ul>
    <a class="subscribe-button icon-feed" href="/feed.xml">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The comment above "< default" means - insert everything in this file into -->
    <!-- the [body] of the default.hbs template, which contains our header/footer. -->

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<header class="main-header post-head " style="background-image: url(/assets/images/syringe.jpg) ">
    <nav class="main-nav  overlay  clearfix">
        
        
            <a class="menu-button icon-menu" href="#"><span class="word">Menu</span></a>
        
    </nav>
</header>

<main class="content" role="main">

    <article class="post tag-fiction">

        <header class="post-header">
            <h1 class="post-title">Dependency Injection</h1>
            <section class="post-meta">
            <!-- <a href='/'></a> -->

            
                
            
                
            
                
                    <a href='/author/valentinob'>Valentino B.</a>
                
            
            <time class="post-date" datetime="2019-01-26">26 Jan 2019</time>
                <!-- [[tags prefix=" on "]] -->
                
                on
                
                    
                       <a href='/tag/Patterns'>Patterns</a>,
                    
                
                    
                       <a href='/tag/Programming'>Programming</a>,
                    
                
                    
                       <a href='/tag/Kotlin'>Kotlin</a>
                    
                
                

                
            </section>
        </header>

        <section class="post-content">

            <p>In der Welt der Software Architektur sind mit der Zeit einige Muster (engl. Patterns) entstanden,
womit man komplexe Probleme meistens auf die gleiche Art und Weise lösen kann.
Vielleicht sind dir einige dieser Patterns bereits bekannt, weil du davon gelesen oder sie angewendet hast.
Heute geht es um das sagenumwobene Design Pattern Dependency Injection (DI) zu deutsch  «Abhängigkeiten injizieren».
Was es nun genau mit DI auf sich hat, lieber Leser, das werde ich dir in diesem Artikel näher bringen. 
Nun ab ans Eingemachte!</p>

<h1 id="einführung">Einführung</h1>
<p>Dir gehen vielleicht gerade einige Fragen durch den Kopf.</p>
<ul>
  <li>Ist es mit SQL Injection verwandt?</li>
  <li>Ist mit Dependency eine Library gemeint die ein Programm verwendet?</li>
  <li>Kann mir eine Dependency injiziert werden?</li>
</ul>

<p>Die Antwort auf alle drei Fragen ist <strong>Nein</strong>!</p>

<p>Das Pattern DI wird im Kontext der objektorientierten Programmierung (OOP) gesehen.</p>

<p>Da wir uns in der OOP Objekte aus der realen Welt modellieren, versuche ich DI mal so zu erklären.
Nehmen wir mal einen Computer. Ein Computer besteht aus vielen Bauteilen. 
Platziert werden diese Bauteile auf dem Mainboard, dessen Aufgabe ist diese zu verbinden,
damit Informationen über elektrische Signale ausgetauscht werden können.</p>

<p><strong>Frage</strong>: Wer liefert Strom an das Mainboard?</p>

<p><em>Es ist das Netzteil.</em></p>

<p>Es wandelt den Wechselstrom in Gleichstrom um, damit alle Teile ordnungsgemäß arbeiten können.
Das tolle an der Sache ist, dass man nicht auf ein bestimmtes Netzteil eines Herstellers angewiesen ist.
Die Leistung (Watt) muss nur gleich oder höher dem des alten Netzteils entsprechen.<br />
D.h man muss eine Art Vertrag einhalten.</p>

<p><strong>Frage</strong>: Wie hält man Verträge beim Programmieren ein?</p>

<p><em>Mit Interfaces.</em></p>

<hr />

<p>Code technisch kann man es so darstellen:</p>

<p>Deklaration von Interfaces</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>interface PowerSupply
interface Mainboard
</code></pre></div></div>

<p>Deklaration von Klassen</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class EightyPLUS : PowerSupply
class ATXFormat : Mainboard
</code></pre></div></div>
<p>ohne DI</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class ATXFormat() : Mainboard {
    val powerSupply: PowerSupply = EightyPLUS()
}
</code></pre></div></div>
<p>mit DI</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class ATXFormat constructor(val powerSupply: PowerSupply) : Mainboard
</code></pre></div></div>

<p>Das Mainboard hat eine Abhängigkeit zum Netzteil. 
Das kann man so ausdrücken <code class="highlighter-rouge">Mainboard -&gt; PowerSupply</code></p>

<h1 id="vorteile">Vorteile</h1>
<p>Ja die gibt es in der Tat. Wenn du dir das obige Beispiel nochmal anschaust, 
dann wirst du festellen, dass die Dependency nicht in der <code class="highlighter-rouge">ATXFormat</code> Klasse hard coded ist.
Ich kann somit ein verschiedenes Netzteil verwenden und bin nicht auf das eine angewiesen.</p>

<p>Ein weiterer Vorteil wird erst ersichtlich, 
nachdem der Abschnitt <a href="#verdrahtung-von-dependencies">Verdrahtung von Dependencies</a> gelesen wurde.</p>

<h1 id="brauche-ich-das">Brauche ich das?</h1>
<p>Da müssen wir uns erstmal Fragen, wann es denn überhaupt sinnvoll ist irgendeine Art von Design Pattern anzuwenden.
Ich antworte mit unser aller Lieblings Antwort: <strong>Es kommt drauf an</strong>.</p>

<p>Oft ist es so, dass man etwas über ein Pattern liest, aber dann gar nicht weiß, ob es sinnvoll für einen selbst anwendbar ist.
Das ist auch nachvollziehbar, wenn man noch nicht an etwas größeren Projekten gearbeitet hat. 
Fakt ist aber das Software ab einer gewissen Größe unheimlich komplex wird, sowohl technisch als auch in der Domäne.
Es treten dann Probleme auf, wofür schlaue Köpfe längst eine Musterlösung parat haben.
Diese Musterlösungen wurden festgehalten und als Buch veröffentlicht. 
Für alle die es interessiert, es ist das Buch “Design Patterns. Elements of Reusable Object-Oriented Software”.</p>

<p>Sry für den kleinen Abschweif. Das soll kein Aufsatz über Design Patterns werden.</p>

<p>Nun zurück zum Wesentlichen. Wenn du ein kleines Programm schreibst, dann werden die Vorteile nicht ersichtlich sein.
Bevor man dann ins Overengineering (Aufwand ist höher als der Nutzen) kommt, kann man es auch so lassen.
Wenn du aber weißt, dass in Zukunft noch einiges dran gemacht wird und das Programm wachsen wird, 
dann kann man vorsorgen und DI kann seine Stärken ausspielen.</p>

<h1 id="arten">Arten</h1>
<p>Es gibt verschiedene Arten dieses Pattern umzusetzen.</p>

<h2 id="setter-injection">Setter Injection</h2>
<p>Das läuft wie der Name es schon vermuten lässt, über eine Setter Methode.</p>

<h2 id="field-injection">Field Injection</h2>
<p>Bekannt in der Java Welt durch Annotationen.
Über eine Annotation wird die Dependency zur Laufzeit verdrahtet.</p>

<h2 id="das-einzig-wahre-constructor-injection">Das einzig Wahre: Constructor Injection</h2>
<p>Jap. Es ist nunmal so. Ich erkläre dir auch wieso.</p>

<p>Konstruktoren sind aus einem gewissen Grund dar. Nachdem du ein Objekt instanziiert hast, sollte es in einem konsistenten Zustand sein.
Mit Setter Methoden kann man das nicht erreichen. Man kann z.B. eine <code class="highlighter-rouge">NullPointerException</code> bekommen, 
wenn man eine Methode aufruft, die eine Property benutzt, die noch nicht gesetzt wurde.</p>
<blockquote>
  <p>Du kannst natürlich Setter Methoden anbieten, wenn du zur Laufzeit irgendwas ändern möchtest.</p>
</blockquote>

<p>Ein weiterer Grund betrifft Unit Tests. 
Bei Field Injection kannst du nicht so ohne weiteres ein Platzhalter (Stub) einsetzen.
Das ist wiederum bei Settern gar kein Problem.</p>

<p>Wenn man das ganze betrachtet bleibt nur noch Constructor Injection übrig.</p>

<blockquote>
  <p>Das habe ich übrigens auch im ersten Codebeispiel verwendet.</p>
</blockquote>

<h1 id="verdrahtung-von-dependencies">Verdrahtung von Dependencies</h1>
<p>Dependencies müssen untereinander verdrahtet werden.
Dabei können unterschiedliche Strukturen entstehen die einen Graphen repräsentieren (Dependency Graph).</p>

<p>Dependencies unter Objekten verlaufen selten linear.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>A -&gt; B -&gt; C
</code></pre></div></div>

<p>Oft ist es so, dass regelrechte Bäume entstehen.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     B -&gt; C
 A -&gt;         F
     D -&gt; E -&gt;
              G
</code></pre></div></div>
<p>Das war jetzt nur ein simples Beispiel. 
In der Praxis ist sowas Standard.</p>

<p>Mit dem Mantra im Sinn, das Klassen nicht allzu groß werden dürfen und somit alles aufgesplittet wird,
können regelrechte Abhängigkeits Explosionen entstehen.
Diese Strukturen von Hand zu verdrahten ist nicht ohne.
Und zugegebenermaßen, wir Informatiker sind faul. 
Da wir uns das Leben einfacher machen wollen, 
gibt es auch bereits eine Lösung dafür und zwar Inversion of Control Container.</p>

<h1 id="di--ioc">DI != IoC</h1>
<p>Inversion of Control (IoC) zu Deutsch «Umkehrung der Steuerung» lässt den Benutzer in den Vordergrund treten.
Nehmen wir mal ein Konsolenprogramm welches deine Eingabe erfordert.
Das Programm steuert den Fluss deiner Interaktion. 
Zu keinem Zeitpunkt kannst du deine Adresse angeben, wenn dein Name gefordert wird.
In einer GUI sieht es anders aus, da du jedes Feld in beliebiger Reihenfolge füllen kannst. 
Da liegt die Macht in deiner Hand.</p>

<p>Betrachten wir das ganze eine Ebene tiefer. 
Nehmen wir mal Callbacks als Beispiel.
Wenn ein Event innerhalb deiner Applikation veröffentlicht wird oder wenn jemand auf einem Button in einer UI klickt. 
Du als Client kannst selber bestimmen was passieren soll, nachdem diese Aktion eingetreten ist.</p>

<p>DI ist nichts anderes als eine Form von IoC. 
Der Client hat hier die Verantwortung die Dependencies zu verdrahten und ist recht flexibel damit, 
weil es nicht hard coded ist.
Durch die Benutzung von Interfaces können jegliche Implementierungen genutzt werden.</p>

<h2 id="ioc-container">IoC Container</h2>
<p>Es gibt Libraries und Frameworks in gängigen Programmiersprachen, die solche IoC Container anbieten.
Nehmen wir mal Java als Beispiel, da ist das Spring Framework die erste Anlaufstelle.</p>

<p>Die wesentliche Aufgaben eines IoC Containers sind</p>
<ul>
  <li>Konstruktion des Dependency Graphs</li>
  <li>Life Cycle Management von Objekten (Man kann sich als Client in verschiedene Zyklen eines Objekts einhaken z.B. nachdem es konstruiert wurde)</li>
  <li>Injizierung von Konfigurations Werten</li>
</ul>

<h2 id="lets-program-an-ioc-container">Let’s program an IoC Container</h2>
<p>Da wir nun über die ganze Theorie Bescheid wissen, wird’s jetzt richtig spannend.</p>

<p>Ich habe einen simplen IoC Container in Kotlin programmiert.
Das Beispiel ist etwas länger geworden und somit habe ich ein Repository auf GitHub angelegt.
Ich habe es da auch ausgiebig beschrieben und kommentiert, allerdings auf Englisch.</p>

<p><a href="https://github.com/Valefant/Addict">https://github.com/Valefant/Addict</a></p>

<h1 id="ende">Ende</h1>
<p>Ich hoffe du konntest einiges aus diesem Artikel mitnehmen.
Falls ihr weitere Vorschläge habt welche Themen wir als nächstes behandeln sollen, gebt uns bitte Bescheid. :-)</p>

<p>Mach dich jedenfalls auf den nächsten Artikel gefasst, denn da nehmen wir WebSockets näher unter die Lupe.</p>


        </section>

        <footer class="post-footer">

            <!-- Everything inside the #author tags pulls data from the author -->
            <!-- #author-->
            
                
            
                
            
                
                    
                        <figure class="author-image">
                            <a class="img" href="/author/valentinob" style="background-image: url(/assets/images/valentinob.jpg)"><span class="hidden">valentinob's Picture</span></a>
                        </figure>
                    

                    <section class="author">
                        <h4><a href="/author/valentinob">Valentino B.</a></h4>

                        
                            <p> German Software-Engineer</p>
                        
                        <div class="author-meta">
                            <span class="author-location icon-location"> Deutschland</span>
                            <span class="author-link icon-link"><a href="https://ososystem.de"> ososystem</a></span>
                        </div>
                    </section>

                    <!-- /author  -->

                    <section class="share">
                        <h4>Share this post</h4>
                        <a class="icon-twitter" href="http://twitter.com/share?text=Dependency Injection&amp;url=https://digitalriding.deDependency-Injection"
                            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                            <span class="hidden">Twitter</span>
                        </a>
                        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://digitalriding.deDependency-Injection"
                            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                            <span class="hidden">Facebook</span>
                        </a>
                        <a class="icon-google-plus" href="https://plus.google.com/share?url=https://digitalriding.deDependency-Injection"
                           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                            <span class="hidden">Google+</span>
                        </a>
                    </section>
                
            

            <!-- Add Disqus Comments -->
            

        </footer>

    </article>

</main>

<aside class="read-next">

    <!-- [[! next_post ]] -->
    
    <!-- [[! /next_post ]] -->
    <!-- [[! prev_post ]] -->
    
        <a class="read-next-story prev " style="background-image: url(/assets/images/fingerprint.jpg)" href="/Proxy-Introduction">
            <section class="post">
                <h2>Ein täuschender Stellvertreter namens John Proxy</h2>
                <p>Lieber Leser, ich weiß dass die Überschrift auf eine spannende Geschichte hindeutet, indem John Proxy...</p>
            </section>
        </a>
    
    <!-- [[! /prev_post ]] -->
</aside>

<!-- /post -->

<style type="text/css">
    .post-optional-information {
        margin: 6em;
    }
</style>


        <!-- The tiny footer at the very bottom -->
        <footer class="site-footer clearfix">
          <section class="copyright"><a href="/">digitalriding</a> &copy; 2019</section>
          <section class="poweredby">Powered by <a href="https://pierrewilken.de/">Pierre Jack Wilken</a></section>
        </footer>
    </div>
    <!-- highlight.js -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- jQuery needs to come before `` so that jQuery can be used in code injection -->
    <script type="text/javascript" src="//code.jquery.com/jquery-1.12.0.min.js"></script>
    <!-- Ghost outputs important scripts and data with this tag -->
    <!--  -->
    <!-- Add Google Analytics  -->
        <!-- Google Analytics Tracking code -->
     <script>
	    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	    ga('create', 'UA-117726176-4', 'auto');
	    ga('send', 'pageview');

     </script>
    <!-- Fitvids makes video embeds responsive and awesome -->
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <!-- The main JavaScript file for Casper -->
    <script type="text/javascript" src="/assets/js/index.js"></script>

</body>
</html>
